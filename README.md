# ACS & Smartcard 密鑰系統
開發環境: Visual Studio 2017
Git: https://github.com/eliza60309/Smartcard

---
## 簡介
這個系統儲存指紋模板，搭配密碼將密鑰加密儲存於智慧卡，並由同樣的密碼與指紋解密出智慧卡上的密鑰，輸入數字以選擇欲使用的服務。
### 1. 註冊指紋
將指紋模板與密碼儲存於系統中：反覆將同一指紋在辨識器上滑過，直到面板上顯示`Progress 100`，並輸入帳號名稱(在系統中指紋模板的檔名)。_密碼在儲存密鑰時才輸入_
### 2. 儲存密鑰
插入智慧卡，輸入欲使用的指紋模板(帳號)，系統會提示用指紋在辨識器上滑過，若辨識相符則可設定保護密鑰用的密碼，輸入完密碼後系統會提示輸入長度為64的十六進位制的密鑰。(_密鑰請不要輸入`0x`_)
### 3. 提取密鑰
插入智慧卡，輸入欲使用的指紋模板(帳號)，系統會提示用指紋在辨識器上滑過，若辨識相符則可輸入保護密鑰用的密碼，完全相符則會印出金鑰
### 4. 模板化智慧卡
插入智慧卡，將初始智慧卡變成本系統可用於存取金鑰的智慧卡
### 5. 離開系統
右上角叉叉有一樣的作用

---
## 程式簡介
### Initialize the ABS Reader
初始化
### `input == 1` 註冊指紋
這裡的程式就是透過API建立一個指紋模板，並將它儲存成檔名為帳號的指紋檔
### `input == 2` 儲存密鑰
要求使用者輸入帳號，選擇帳號就是在選擇指紋檔
建立一個指紋模板實例，並將使用者選擇的指紋檔讀取至該實例。
透過API進行一次指紋認證，若認證成功則要求設定密碼，將密碼與指紋模板分別進行`sha256`，並將結果串聯在一起再做一次`sha256`，最終的結果就是AES對稱加密的金鑰。
這裡使用的`sha256`函式，輸出輸入皆為字串，所以需額外將其轉換為十六進位制
要求使用者輸入64字元的密鑰，以前述的AES金鑰將密鑰進行加密，並將結果儲存於智慧卡
### `input == 3` 提取密鑰
要求使用者輸入帳號
將帳號對應的指紋檔讀取出來
透過API進行一次指紋認證，若認證成功則要求輸入密碼
並將密碼與指紋進行與上述相同的`hash`
錯誤的密碼將會導致錯誤的AES金鑰，提取出來的密鑰當然也是錯的
若是正確則會從智慧卡中提出密鑰並做AES解密
### `input == 4` 模板化智慧卡
從範例Code慢慢試的結果，我也不太懂...
